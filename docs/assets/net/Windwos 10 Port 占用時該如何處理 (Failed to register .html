<html>
<head>
  <title>Windwos 10 Port 占用時該如何處理 (Failed to register url for site 0x80070020)</title>
  <basefont face="微軟正黑體" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/308919 (zh-TW, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微軟正黑體;
      font-size: 14pt;
    }
  </style>
</head>
<body>
<a name="13420"/>

<div>
<span><div><div><div><font style="font-size: 14pt;"><br/></font></div><div style="text-align: center;"><span style="font-size: 24pt;"><span style="font-size: 24pt; font-weight: bold;">Windwos 10 Port 占用時該如何處理 (Failed to register url for site 0x80070020)</span></span></div><div style="text-align: center;"><br/></div><hr/><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 14pt;">某一天我在執行WebFrom 的 Debug出現了 Failed to register url for site 0x80070020，0x80070020這個錯誤代碼代表Port被占用，所以一般代表已經被使用所以衝突到了。</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14pt;">netstat -aon | findstr {Port}</font></div></div><div><span style="font-size: 14pt;">Ex.</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="font-size: 14pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">netstat -aon | findstr</span> <span style="font-size: 14pt; background-color: rgb(255, 250, 165);-evernote-highlight:true;">50101</span></span></div><div><span style="font-size: 14pt;">一開始我使用cmd 指令</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 14pt;">如果你可以查詢的到那就依照 查詢出來的PID(最後面那組數字)</span></div><div><span style="font-size: 14pt;"><br/></span></div><hr/><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 828px;"></col><col style="width: 852px;"></col></colgroup><tbody><tr><td style="width: 828px; padding: 8px; border: 1px solid;"><div><span style="font-size: 14pt;">詳細資料</span></div></td><td style="width: 852px; padding: 8px; border: 1px solid;"><div><span style="font-size: 14pt;"><br/></span></div></td></tr><tr><td style="width: 828px; padding: 8px; border: 1px solid;"><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div></td><td style="width: 852px; padding: 8px; border: 1px solid;"><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image [4].png" type="image/png" data-filename="Image.png"/></span></div></td></tr></tbody></table><div><span style="font-size: 14pt;">到工作管理員=&gt;更多詳細資訊=&gt;詳細資料or服務，去找到對應的PID停止服務</span></div></div><div><span style="font-size: 14pt;"><br/></span></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 14pt;">netstat -aon | findstr {Port}</span></div></div><div><span style="font-size: 14pt;">Ex.</span><span style="background-color: rgb(255, 250, 165);font-size: 14pt;-evernote-highlight:true;">netstat -aon | findstr</span> <span style="background-color: rgb(255, 250, 165);font-size: 14pt;-evernote-highlight:true;">50101</span></div><div><span style="font-size: 14pt;">最後依樣使用指令來確認此Port是否有被正確釋放。</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt;">可是我用指令查了半天就是沒有發現，</span><span style="font-size: 14pt;">後來剛好看報保哥的文章頓時發現，原來作業系統是有保留Port的。</span></div><div><a href="https://blog.miniasp.com/post/2019/03/31/Ports-blocked-by-Windows-10-for-unknown-reason" style="font-size: 14pt;">https://blog.miniasp.com/post/2019/03/31/Ports-blocked-by-Windows-10-for-unknown-reason</a>(保哥文章原文)</div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt;"><img src="Windwos 10 Port 占用時該如何處理 (Failed to register _files/Image [5].png" type="image/png" data-filename="Image.png"/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14pt;">netsh int ipv4 show excludedportrange protocol=tcp</font></div></div><div><span style="font-size: 14pt;">可以看到這裡我的50101在範圍內被保留了......所以才不允許我使用.......</span></div><div><font style="font-size: 14pt;"><br/></font></div><hr/><div><font style="font-size: 14pt;"><br/></font></div><div style="text-align: center;"><font style="font-size: 18pt;"><span style="font-size: 18pt; font-weight: bold;">解決方法</span></font></div><div style="text-align: center;"><font style="font-size: 24pt;"><br/></font></div><div><span style="font-size: 14pt;">我是參考保哥的方法，以下指令有兩組可以讓使用者自訂保留的Port，並且重新開機也會繼續存在</span></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 14pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14pt;">netsh int ipv4 add excludedportrange protocol=tcp numberofports=1 startport={port}</font></div></div><div><span style="font-size: 14pt;">新增(ex.</span> <span style="background-color: rgb(255, 250, 165);font-size: 14pt;-evernote-highlight:true;">netsh int ipv4 add excludedportrange protocol=tcp numberofports=1 startport=50101</span><span style="font-size: 14pt;">)</span></div><div><font style="font-size: 14pt;"><br/></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 14pt;">netsh int ipv4 delete excludedportrange protocol=tcp numberofports=1 startport={port}</font></div></div><div><span style="font-size: 14pt;">移除(ex.</span> <span style="background-color: rgb(255, 250, 165);font-size: 14pt;-evernote-highlight:true;">netsh int ipv4 delete excludedportrange protocol=tcp numberofports=1 startport=</span><span style="background-color: rgb(255, 250, 165); font-size: 14pt;-evernote-highlight:true;">50101</span><span style="font-size: 14pt;">)</span></div><div><br/></div></div><hr/><div><br/></div><div style="text-align: center;"><font style="font-size: 18pt;"><span style="font-size: 18pt; font-weight: bold;">參考資料</span></font></div><div><br/></div><div><a href="https://blog.miniasp.com/post/2019/03/31/Ports-blocked-by-Windows-10-for-unknown-reason" style="font-size: 14pt;">https://blog.miniasp.com/post/2019/03/31/Ports-blocked-by-Windows-10-for-unknown-reason</a></div></div><div><br/></div></span>
</div></body></html> 